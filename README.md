# SIEM-Detection-and-Content-Planning-Framework
Описание используемого подхода к планированию контента обнаружения SIEM c пошаговым набором действия.

## Содержание
- [Общие положения](#Общие-положения)
- [Основные этапы методики планирования разработки контента](#Основные-этапы-методики-планирования-разработки-контента)
- [Реализация процесса планирования разработки контента обнаружения](#Реализация-процесса-планирования-разработки-контента-обнаружения)
- [Работа с дополнительным материалом](#Работа-с-дополнительным-материалом)
- [Команда проекта](#команда-проекта)
- [Источники](#источники)


### Общие положения методики:
1. Под контентом обнаружения понимается совокупность правил корреляции и связанные с ними ресурсы (фильтры, активные листы, таблицы, словари, правила реагирования) в рамках отдельно взятой SIEM-системы.
2. Под планированием разработки контента обнаружения понимается процесс, направленный на установление перечня и описания необходимой корреляционной логики для SIEM системы с учётом внутренних и внешних факторов, влияющих на защищённость организации и её частей. 
3. Исходными данными для запуска процесса планирования и разработки являются внутренние и внешние факторы, предоставляющие информацию для анализа, генерации корреляционной логики и её последующей приоритизации.
   Следует учесть следующие источники:
- [ ] Особенности инфраструктуры и источников событий
- [ ] Текущий ландшафт угроз
- [ ] Анализ и оценку текущего уровня покрытия защищаемой инфраструктуры корреляционной логикой
- [ ] Потребности команды detection engineering
4. На основании проведенного анализа формируется и отбирается список правил корреляции, входящий в состав перечня планируемого контента к разработке.
- [ ] критичность целевой системы;
- [ ] критичность последствий реализации атаки;
- [ ] наличие техники/процедуры в свежих отчетах Threat Intelligence (TI) и Threat Hunting (TH) команд
- [ ] «массовость правила»;
- [ ] трудоёмкость правила»;
- [ ] применение правила к задачам обеспечения ИБ;
- [ ] актуальность правила обнаружения;

### Основные этапы методики планирования разработки контента
#### Анализ исходных данных: 
1.	Анализ модели угроз организации, на предмет непокрытых угроз;
2.	Анализ текущего ландшафта угроз;
3.	Анализ поверхности атаки;
4.	Особенности инфраструктуры и источников событий; 
5.	Анализ и оценка текущего уровня покрытия защищаемой инфраструктуры корреляционной логикой;
6.	Анализ запросов на разработку корреляционной логики от команды Detection Engeneering;
   
![image](https://github.com/user-attachments/assets/ea5f24fe-63a0-4445-9edc-a1ec7cdd2e26)

#### Приоритизация разработки корреляционной логики
1. Определение критериев выборки, ниже представлен примерный шаблон:
- Уровень потенциальной угрозы (Impact Level);
- Доступность логов и данных (Log Availabillity);
- Уровень ложных срабатываний (False Positive Rate)
- Ширина охвата правил (Rule Coverage);

![image](https://github.com/user-attachments/assets/9af993cb-7200-4a85-b5c6-7e758e6fd1f2)



#### Реализация процесса планирования разработки контента обнаружения]
1. Формирование этапов планирования
   ![image](https://github.com/user-attachments/assets/ba538838-d292-44b4-90fc-4f06000b4607)

2. Выстраивание взаимосвязи
   
![image](https://github.com/user-attachments/assets/56acc6a2-158e-4842-9a72-3637b49fc1b0)

3. Формирование первичного перечня правил их их приоритезация с помощью скоринговой модели
![image](https://github.com/user-attachments/assets/7a018d80-235c-454e-8aaf-c9a609d807a3)

Более подробно критерии описаны в шаблоне скоринг модели.

### Работа с дополнительным материалом
Для заполнения и запуска проекта, необходим [MITRE ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/#layerURL=)

Для установки зависимостей, заполните шаблон MITRE Coverage.json:
```sh
{
    "name": "Technique Inference Engine (TIE) Prediction Heatmap",
    "versions": {
        "layer": "4.5",
        "attack": "14",
        "navigator": "4.8.1"
    },
    "domain": "enterprise-attack",
    "description": "Heatmap of predicted techniques generated from Technique Inference Engine (TIE)",
    "filters": {
        "platforms": [ // Определите целевые платформы, или оставьте поумолчанию 
            "Linux",
            "macOS",
            "Windows",
            "Network",
            "PRE",
            "Containers",
            "Office 365",
            "Saas",
            "Google Workspace",
            "IaaS",
            "Azure AD"
        ]
    },
    "sorting": 0,
    "layout": {
        "layout": "side",
        "aggregateFunction": "average",
        "showID": false,
        "showName": true,
        "showAggregateScores": false,
        "countUnscored": false
    },
    "hideDisabled": false,
    "techniques": [
        {
            "techniqueID": "<ID техники, например T1571>", // подставьте подходящий ID техники
            "score": 1,
            "color": "#5ee66e", 
            "tactic": "command-and-control",
            "metadata": [
                {
                    "name": "Rule",
                    "value": "<Название правила>" // обозначьте наименование правила корреляции
                }
            ]
        },
        {
            "techniqueID": "T1546.011",  // пример с несколькими правилами
            "score": 1,
            "color": "#5ee66e",
            "tactic": "privilege-escalation",
            "metadata": [
                {
                    "name": "Rule",
                    "value": "Злоупотребление подсистемой совместимости приложений. Новый  Shim индикатор в БД." // 
                },
                {
                    "name": "Rule",
                    "value": "Злоупотребление подсистемой совместимости приложений. PE Original Filename или Hash Indicator"
                },
                {
                    "name": "Rule",
                    "value": "Злоупотребление подсистемой совместимости приложений. Индикатор реестра"
                }
            ]
        },
    // копируйте блоки для описания дальнейших процедур
```
Загрузите сформированный шаблон в MITRE Navigator c помощью вызова Upload from local
![image](https://github.com/user-attachments/assets/ee71eb3e-c3e3-4189-8065-6ddda5ccf1bc)
