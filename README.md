# SIEM-Detection-and-Content-Planning-Framework
Подход к планированию разработки базового детектирующего контента (контента обнаружения) для SIEM систем. How-to методика c пошаговым набором действия, направленная на подготовку конкретных сценариев обнаружения и формирования драфта технического задания по разработке корреляционных правила для SIEM в условиях ограниченных ресурсов.

![image](https://github.com/user-attachments/assets/3be7bf53-41b7-44ab-b4a5-46526d79e05d)

## Содержание
- [Общие положения](#Общие-положения-методики)
- [Основные этапы методики планирования разработки контента](#Основные-этапы-методики-планирования-разработки-контента)
- [Реализация процесса планирования разработки контента обнаружения](#Реализация-процесса-планирования-разработки-контента-обнаружения)
- [Работа с дополнительным материалом](#Работа-с-дополнительным-материалом)
- [Команда проекта](#команда-проекта)
- [Источники](#источники)


### Общие положения методики:
1. Под контентом обнаружения понимается совокупность правил корреляции и связанные с ними ресурсы (фильтры, активные листы/списки, таблицы, словари, правила реагирования) в рамках отдельно взятой SIEM-системы.
2. Под планированием разработки контента обнаружения понимается процесс, направленный на установление перечня и описания необходимой корреляционной логики для SIEM системы с учётом внутренних и внешних факторов, влияющих на защищённость организации и её частей. 
3. Исходными данными для запуска процесса планирования и разработки являются внутренние и внешние факторы, предоставляющие информацию для анализа, генерации корреляционной логики и её последующей приоритизации.
   Следует учесть следующие источники:
- [ ] Особенности инфраструктуры, защищаемых активов и источников событий
- [ ] Текущий ландшафт угроз
- [ ] Анализ и оценку текущего уровня покрытия защищаемой инфраструктуры корреляционной логикой
- [ ] Потребности команды detection engineering
4. На основании проведенного анализа формируется и отбирается список правил корреляции, входящий в состав перечня планируемого контента к разработке.


### Основные этапы методики планирования разработки контента
#### Анализ исходных данных: 
1.  Фиксация защищаемых объектов (площадки -> Сегменты сети -> Системы -> Активы (иточники логов)
2.  Анализ текущего ландшафта угроз и модели угроз организации, на предмет непокрытых угроз
3.  Анализ поверхности атаки
4.  Анализ и оценка текущего уровня покрытия защищаемой инфраструктуры корреляционной логикой
5.  Анализ запросов на разработку корреляционной логики от команды Detection Engeneering
6.  Проработка сценариев детектирующей логики
7.  Формализация и обогащение детектирующей логики

![image](https://github.com/user-attachments/assets/61d00622-efd9-471b-b385-48dfc723f652)

Формирование этапов планирования
   ![image](https://github.com/user-attachments/assets/53be8453-8366-4c73-90cc-a1cae5429c71)


#### Приоритизация разработки корреляционной логики
1. Определение критериев выборки, ниже представлен примерный шаблон:
- Уровень потенциальной угрозы (Impact Level)
- Доступность логов и данных (Log Availabillity)
- Уровень ложных срабатываний (False Positive Rate)
- Ширина охвата правил (Rule Coverage)
- Правило Парето (20/80)

![image](https://github.com/user-attachments/assets/9af993cb-7200-4a85-b5c6-7e758e6fd1f2)

##### Уровень потенциальной угрозы (Impact Level)
Оценивается потенциальный ущерб, который может нанести техника или атака, если она не будет выявлена.
- 5 — Критическая угроза. Полная остановка ключевых бизнес-процессов, утечка или компрометация критически важных данных, что приводит к долгосрочным и серьезным последствиям для бизнеса, включая финансовые потери и нарушение обязательств.
- 4 — Существенная угроза. Значительные сбои в работе, временные простои ключевых систем или компрометация важных данных, которая может негативно отразиться на операциях компании, но не останавливает бизнес полностью.
- 3 — Умеренная угроза. Влияние на второстепенные системы и данные, временные перебои в бизнес-процессах, которые не критичны для основной деятельности компании, но требуют дополнительных ресурсов для восстановления.
- 2 — Низкий ущерб. Ограниченное влияние на менее важные элементы инфраструктуры, которое почти не сказывается на основных операциях и не требует срочного вмешательства.
- 1 — Минимальный ущерб. Незначительное влияние или отсутствие ощутимого ущерба для бизнеса, любые проблемы могут быть устранены без дополнительных затрат или влияния на основные процессы.

##### Частота использования техники (Frequency)
Оценивается, насколько часто данная техника или тип атаки используется в реальных кибератаках. Это можно основывать на данных отраслевой статистики или опыте SOC.
- 5 — Очень часто используется (широко распространённые атаки, такие как фишинг, эксплойты веб-приложений).
- 4 — Часто используется (например, атаки на повышенные привилегии).
- 3 — Умеренно распространённая (инфильтрация через редкие уязвимости).
- 2 — Редко используется (модернизация инструментов, редкие техники).
- 1 — Очень редко встречается (новые кастомные инструменты, эксплуатация 0-day).

##### Доступность логов и данных (Log Availability)
Оценивается, насколько легко можно получить данные или логи для создания корреляционного правила (наличие данных в SIEM).
- 5 — Логи доступны (например, уже настроенные источники логов).
- 4 — Логи легко доступны с минимальными настройками, есть готовая нормализация.
- 3 — Логи можно собрать, но потребуется доработка уровня логирования и механизмов передачи, возможна корректировка нормализации.
- 2 — Логи затруднительно собрать, потребуется значительная перенастройка источника или инфраструктуры, разработка запросов и парсеров с нуля.
- 1 — Логи практически недоступны или отсутствуют.

##### Уровень ложных срабатываний (False Positive Rate)
Оценивается риск появления ложных срабатываний при внедрении правила.
- 5 — Очень низкий риск ложных срабатываний (FP Rate – 10%).
- 4 — Низкий риск ложных срабатываний (FP Rate – 10-20%).
- 3 — Средний риск FP Rate – 20-40% (правило периодически будет требовать доработок и внесения исключений).
- 2 — Высокий риск FP Rate – 40-75% (правило создаёт значительную нагрузку на аналитиков, постоянно требует доработок и внесения исключений при изменениях в инфраструктуре).
- 1 — Очень высокий риск (FP Rate – 75+%) (крайне шумное и неинформативное правило, проще осуществлять детект другими средствами, чем обрабатывать все сработки).

![image](https://github.com/user-attachments/assets/88b43d27-24c7-4dcc-9bb0-0a2ada3aaf1d)


#### Реализация процесса планирования разработки контента обнаружения]
Пример — OS Windows 
![image](https://github.com/user-attachments/assets/e86a81be-1e16-4075-b049-35a9c1062184)
Пример — Network
![image](https://github.com/user-attachments/assets/6e6693fe-9293-4864-bfe0-727e23e2ebfa)
Пример — Bussiness Critical Applications + OS Linux
![image](https://github.com/user-attachments/assets/da55e4da-5532-4746-b890-64a5e8c96a4a)


### Работа с дополнительным материалом
Для заполнения и запуска проекта, необходим [MITRE ATT&CK Navigator](https://mitre-attack.github.io/attack-navigator/#layerURL=)
